#include <cstdlib>
#include <string>
#include <unordered_map>
#include <utility>

#include "ctype.hh"
#include "color.hh"

unsigned ParseColorName(std::u32string_view s)
{
    return ParseColorName(ToUTF8(s));
}

static std::unordered_map<std::string,unsigned> colornames
{
/*
perl -pe "s/(\d+)\s+(\d+)\s+(\d+)\s+(.*)/ {\"\\4\", Repack({\\1,\\2,\\3}) },/" < /usr/share/X11/rgb.txt|tr A-Z a-z
*/
 {"snow", Repack({255,250,250}) },
 {"ghost white", Repack({248,248,255}) },
 {"ghostwhite", Repack({248,248,255}) },
 {"white smoke", Repack({245,245,245}) },
 {"whitesmoke", Repack({245,245,245}) },
 {"gainsboro", Repack({220,220,220}) },
 {"floral white", Repack({255,250,240}) },
 {"floralwhite", Repack({255,250,240}) },
 {"old lace", Repack({253,245,230}) },
 {"oldlace", Repack({253,245,230}) },
 {"linen", Repack({250,240,230}) },
 {"antique white", Repack({250,235,215}) },
 {"antiquewhite", Repack({250,235,215}) },
 {"papaya whip", Repack({255,239,213}) },
 {"papayawhip", Repack({255,239,213}) },
 {"blanched almond", Repack({255,235,205}) },
 {"blanchedalmond", Repack({255,235,205}) },
 {"bisque", Repack({255,228,196}) },
 {"peach puff", Repack({255,218,185}) },
 {"peachpuff", Repack({255,218,185}) },
 {"navajo white", Repack({255,222,173}) },
 {"navajowhite", Repack({255,222,173}) },
 {"moccasin", Repack({255,228,181}) },
 {"cornsilk", Repack({255,248,220}) },
 {"ivory", Repack({255,255,240}) },
 {"lemon chiffon", Repack({255,250,205}) },
 {"lemonchiffon", Repack({255,250,205}) },
 {"seashell", Repack({255,245,238}) },
 {"honeydew", Repack({240,255,240}) },
 {"mint cream", Repack({245,255,250}) },
 {"mintcream", Repack({245,255,250}) },
 {"azure", Repack({240,255,255}) },
 {"alice blue", Repack({240,248,255}) },
 {"aliceblue", Repack({240,248,255}) },
 {"lavender", Repack({230,230,250}) },
 {"lavender blush", Repack({255,240,245}) },
 {"lavenderblush", Repack({255,240,245}) },
 {"misty rose", Repack({255,228,225}) },
 {"mistyrose", Repack({255,228,225}) },
 {"white", Repack({255,255,255}) },
   {"black", Repack({0,0,0}) },
  {"dark slate gray", Repack({47,79,79}) },
  {"darkslategray", Repack({47,79,79}) },
  {"dark slate grey", Repack({47,79,79}) },
  {"darkslategrey", Repack({47,79,79}) },
 {"dim gray", Repack({105,105,105}) },
 {"dimgray", Repack({105,105,105}) },
 {"dim grey", Repack({105,105,105}) },
 {"dimgrey", Repack({105,105,105}) },
 {"slate gray", Repack({112,128,144}) },
 {"slategray", Repack({112,128,144}) },
 {"slate grey", Repack({112,128,144}) },
 {"slategrey", Repack({112,128,144}) },
 {"light slate gray", Repack({119,136,153}) },
 {"lightslategray", Repack({119,136,153}) },
 {"light slate grey", Repack({119,136,153}) },
 {"lightslategrey", Repack({119,136,153}) },
 {"gray", Repack({190,190,190}) },
 {"grey", Repack({190,190,190}) },
 {"light grey", Repack({211,211,211}) },
 {"lightgrey", Repack({211,211,211}) },
 {"light gray", Repack({211,211,211}) },
 {"lightgray", Repack({211,211,211}) },
  {"midnight blue", Repack({25,25,112}) },
  {"midnightblue", Repack({25,25,112}) },
   {"navy", Repack({0,0,128}) },
   {"navy blue", Repack({0,0,128}) },
   {"navyblue", Repack({0,0,128}) },
 {"cornflower blue", Repack({100,149,237}) },
 {"cornflowerblue", Repack({100,149,237}) },
  {"dark slate blue", Repack({72,61,139}) },
  {"darkslateblue", Repack({72,61,139}) },
 {"slate blue", Repack({106,90,205}) },
 {"slateblue", Repack({106,90,205}) },
 {"medium slate blue", Repack({123,104,238}) },
 {"mediumslateblue", Repack({123,104,238}) },
 {"light slate blue", Repack({132,112,255}) },
 {"lightslateblue", Repack({132,112,255}) },
   {"medium blue", Repack({0,0,205}) },
   {"mediumblue", Repack({0,0,205}) },
  {"royal blue", Repack({65,105,225}) },
  {"royalblue", Repack({65,105,225}) },
   {"blue", Repack({0,0,255}) },
  {"dodger blue", Repack({30,144,255}) },
  {"dodgerblue", Repack({30,144,255}) },
   {"deep sky blue", Repack({0,191,255}) },
   {"deepskyblue", Repack({0,191,255}) },
 {"sky blue", Repack({135,206,235}) },
 {"skyblue", Repack({135,206,235}) },
 {"light sky blue", Repack({135,206,250}) },
 {"lightskyblue", Repack({135,206,250}) },
  {"steel blue", Repack({70,130,180}) },
  {"steelblue", Repack({70,130,180}) },
 {"light steel blue", Repack({176,196,222}) },
 {"lightsteelblue", Repack({176,196,222}) },
 {"light blue", Repack({173,216,230}) },
 {"lightblue", Repack({173,216,230}) },
 {"powder blue", Repack({176,224,230}) },
 {"powderblue", Repack({176,224,230}) },
 {"pale turquoise", Repack({175,238,238}) },
 {"paleturquoise", Repack({175,238,238}) },
   {"dark turquoise", Repack({0,206,209}) },
   {"darkturquoise", Repack({0,206,209}) },
  {"medium turquoise", Repack({72,209,204}) },
  {"mediumturquoise", Repack({72,209,204}) },
  {"turquoise", Repack({64,224,208}) },
   {"cyan", Repack({0,255,255}) },
 {"light cyan", Repack({224,255,255}) },
 {"lightcyan", Repack({224,255,255}) },
  {"cadet blue", Repack({95,158,160}) },
  {"cadetblue", Repack({95,158,160}) },
 {"medium aquamarine", Repack({102,205,170}) },
 {"mediumaquamarine", Repack({102,205,170}) },
 {"aquamarine", Repack({127,255,212}) },
   {"dark green", Repack({0,100,0}) },
   {"darkgreen", Repack({0,100,0}) },
  {"dark olive green", Repack({85,107,47}) },
  {"darkolivegreen", Repack({85,107,47}) },
 {"dark sea green", Repack({143,188,143}) },
 {"darkseagreen", Repack({143,188,143}) },
  {"sea green", Repack({46,139,87}) },
  {"seagreen", Repack({46,139,87}) },
  {"medium sea green", Repack({60,179,113}) },
  {"mediumseagreen", Repack({60,179,113}) },
  {"light sea green", Repack({32,178,170}) },
  {"lightseagreen", Repack({32,178,170}) },
 {"pale green", Repack({152,251,152}) },
 {"palegreen", Repack({152,251,152}) },
   {"spring green", Repack({0,255,127}) },
   {"springgreen", Repack({0,255,127}) },
 {"lawn green", Repack({124,252,0}) },
 {"lawngreen", Repack({124,252,0}) },
   {"green", Repack({0,255,0}) },
 {"chartreuse", Repack({127,255,0}) },
   {"medium spring green", Repack({0,250,154}) },
   {"mediumspringgreen", Repack({0,250,154}) },
 {"green yellow", Repack({173,255,47}) },
 {"greenyellow", Repack({173,255,47}) },
  {"lime green", Repack({50,205,50}) },
  {"limegreen", Repack({50,205,50}) },
 {"yellow green", Repack({154,205,50}) },
 {"yellowgreen", Repack({154,205,50}) },
  {"forest green", Repack({34,139,34}) },
  {"forestgreen", Repack({34,139,34}) },
 {"olive drab", Repack({107,142,35}) },
 {"olivedrab", Repack({107,142,35}) },
 {"dark khaki", Repack({189,183,107}) },
 {"darkkhaki", Repack({189,183,107}) },
 {"khaki", Repack({240,230,140}) },
 {"pale goldenrod", Repack({238,232,170}) },
 {"palegoldenrod", Repack({238,232,170}) },
 {"light goldenrod yellow", Repack({250,250,210}) },
 {"lightgoldenrodyellow", Repack({250,250,210}) },
 {"light yellow", Repack({255,255,224}) },
 {"lightyellow", Repack({255,255,224}) },
 {"yellow", Repack({255,255,0}) },
 {"gold", Repack({255,215,0}) },
 {"light goldenrod", Repack({238,221,130}) },
 {"lightgoldenrod", Repack({238,221,130}) },
 {"goldenrod", Repack({218,165,32}) },
 {"dark goldenrod", Repack({184,134,11}) },
 {"darkgoldenrod", Repack({184,134,11}) },
 {"rosy brown", Repack({188,143,143}) },
 {"rosybrown", Repack({188,143,143}) },
 {"indian red", Repack({205,92,92}) },
 {"indianred", Repack({205,92,92}) },
 {"saddle brown", Repack({139,69,19}) },
 {"saddlebrown", Repack({139,69,19}) },
 {"sienna", Repack({160,82,45}) },
 {"peru", Repack({205,133,63}) },
 {"burlywood", Repack({222,184,135}) },
 {"beige", Repack({245,245,220}) },
 {"wheat", Repack({245,222,179}) },
 {"sandy brown", Repack({244,164,96}) },
 {"sandybrown", Repack({244,164,96}) },
 {"tan", Repack({210,180,140}) },
 {"chocolate", Repack({210,105,30}) },
 {"firebrick", Repack({178,34,34}) },
 {"brown", Repack({165,42,42}) },
 {"dark salmon", Repack({233,150,122}) },
 {"darksalmon", Repack({233,150,122}) },
 {"salmon", Repack({250,128,114}) },
 {"light salmon", Repack({255,160,122}) },
 {"lightsalmon", Repack({255,160,122}) },
 {"orange", Repack({255,165,0}) },
 {"dark orange", Repack({255,140,0}) },
 {"darkorange", Repack({255,140,0}) },
 {"coral", Repack({255,127,80}) },
 {"light coral", Repack({240,128,128}) },
 {"lightcoral", Repack({240,128,128}) },
 {"tomato", Repack({255,99,71}) },
 {"orange red", Repack({255,69,0}) },
 {"orangered", Repack({255,69,0}) },
 {"red", Repack({255,0,0}) },
 {"hot pink", Repack({255,105,180}) },
 {"hotpink", Repack({255,105,180}) },
 {"deep pink", Repack({255,20,147}) },
 {"deeppink", Repack({255,20,147}) },
 {"pink", Repack({255,192,203}) },
 {"light pink", Repack({255,182,193}) },
 {"lightpink", Repack({255,182,193}) },
 {"pale violet red", Repack({219,112,147}) },
 {"palevioletred", Repack({219,112,147}) },
 {"maroon", Repack({176,48,96}) },
 {"medium violet red", Repack({199,21,133}) },
 {"mediumvioletred", Repack({199,21,133}) },
 {"violet red", Repack({208,32,144}) },
 {"violetred", Repack({208,32,144}) },
 {"magenta", Repack({255,0,255}) },
 {"violet", Repack({238,130,238}) },
 {"plum", Repack({221,160,221}) },
 {"orchid", Repack({218,112,214}) },
 {"medium orchid", Repack({186,85,211}) },
 {"mediumorchid", Repack({186,85,211}) },
 {"dark orchid", Repack({153,50,204}) },
 {"darkorchid", Repack({153,50,204}) },
 {"dark violet", Repack({148,0,211}) },
 {"darkviolet", Repack({148,0,211}) },
 {"blue violet", Repack({138,43,226}) },
 {"blueviolet", Repack({138,43,226}) },
 {"purple", Repack({160,32,240}) },
 {"medium purple", Repack({147,112,219}) },
 {"mediumpurple", Repack({147,112,219}) },
 {"thistle", Repack({216,191,216}) },
 {"snow1", Repack({255,250,250}) },
 {"snow2", Repack({238,233,233}) },
 {"snow3", Repack({205,201,201}) },
 {"snow4", Repack({139,137,137}) },
 {"seashell1", Repack({255,245,238}) },
 {"seashell2", Repack({238,229,222}) },
 {"seashell3", Repack({205,197,191}) },
 {"seashell4", Repack({139,134,130}) },
 {"antiquewhite1", Repack({255,239,219}) },
 {"antiquewhite2", Repack({238,223,204}) },
 {"antiquewhite3", Repack({205,192,176}) },
 {"antiquewhite4", Repack({139,131,120}) },
 {"bisque1", Repack({255,228,196}) },
 {"bisque2", Repack({238,213,183}) },
 {"bisque3", Repack({205,183,158}) },
 {"bisque4", Repack({139,125,107}) },
 {"peachpuff1", Repack({255,218,185}) },
 {"peachpuff2", Repack({238,203,173}) },
 {"peachpuff3", Repack({205,175,149}) },
 {"peachpuff4", Repack({139,119,101}) },
 {"navajowhite1", Repack({255,222,173}) },
 {"navajowhite2", Repack({238,207,161}) },
 {"navajowhite3", Repack({205,179,139}) },
 {"navajowhite4", Repack({139,121,94}) },
 {"lemonchiffon1", Repack({255,250,205}) },
 {"lemonchiffon2", Repack({238,233,191}) },
 {"lemonchiffon3", Repack({205,201,165}) },
 {"lemonchiffon4", Repack({139,137,112}) },
 {"cornsilk1", Repack({255,248,220}) },
 {"cornsilk2", Repack({238,232,205}) },
 {"cornsilk3", Repack({205,200,177}) },
 {"cornsilk4", Repack({139,136,120}) },
 {"ivory1", Repack({255,255,240}) },
 {"ivory2", Repack({238,238,224}) },
 {"ivory3", Repack({205,205,193}) },
 {"ivory4", Repack({139,139,131}) },
 {"honeydew1", Repack({240,255,240}) },
 {"honeydew2", Repack({224,238,224}) },
 {"honeydew3", Repack({193,205,193}) },
 {"honeydew4", Repack({131,139,131}) },
 {"lavenderblush1", Repack({255,240,245}) },
 {"lavenderblush2", Repack({238,224,229}) },
 {"lavenderblush3", Repack({205,193,197}) },
 {"lavenderblush4", Repack({139,131,134}) },
 {"mistyrose1", Repack({255,228,225}) },
 {"mistyrose2", Repack({238,213,210}) },
 {"mistyrose3", Repack({205,183,181}) },
 {"mistyrose4", Repack({139,125,123}) },
 {"azure1", Repack({240,255,255}) },
 {"azure2", Repack({224,238,238}) },
 {"azure3", Repack({193,205,205}) },
 {"azure4", Repack({131,139,139}) },
 {"slateblue1", Repack({131,111,255}) },
 {"slateblue2", Repack({122,103,238}) },
 {"slateblue3", Repack({105,89,205}) },
  {"slateblue4", Repack({71,60,139}) },
  {"royalblue1", Repack({72,118,255}) },
  {"royalblue2", Repack({67,110,238}) },
  {"royalblue3", Repack({58,95,205}) },
  {"royalblue4", Repack({39,64,139}) },
   {"blue1", Repack({0,0,255}) },
   {"blue2", Repack({0,0,238}) },
   {"blue3", Repack({0,0,205}) },
   {"blue4", Repack({0,0,139}) },
  {"dodgerblue1", Repack({30,144,255}) },
  {"dodgerblue2", Repack({28,134,238}) },
  {"dodgerblue3", Repack({24,116,205}) },
  {"dodgerblue4", Repack({16,78,139}) },
  {"steelblue1", Repack({99,184,255}) },
  {"steelblue2", Repack({92,172,238}) },
  {"steelblue3", Repack({79,148,205}) },
  {"steelblue4", Repack({54,100,139}) },
   {"deepskyblue1", Repack({0,191,255}) },
   {"deepskyblue2", Repack({0,178,238}) },
   {"deepskyblue3", Repack({0,154,205}) },
   {"deepskyblue4", Repack({0,104,139}) },
 {"skyblue1", Repack({135,206,255}) },
 {"skyblue2", Repack({126,192,238}) },
 {"skyblue3", Repack({108,166,205}) },
  {"skyblue4", Repack({74,112,139}) },
 {"lightskyblue1", Repack({176,226,255}) },
 {"lightskyblue2", Repack({164,211,238}) },
 {"lightskyblue3", Repack({141,182,205}) },
  {"lightskyblue4", Repack({96,123,139}) },
 {"slategray1", Repack({198,226,255}) },
 {"slategray2", Repack({185,211,238}) },
 {"slategray3", Repack({159,182,205}) },
 {"slategray4", Repack({108,123,139}) },
 {"lightsteelblue1", Repack({202,225,255}) },
 {"lightsteelblue2", Repack({188,210,238}) },
 {"lightsteelblue3", Repack({162,181,205}) },
 {"lightsteelblue4", Repack({110,123,139}) },
 {"lightblue1", Repack({191,239,255}) },
 {"lightblue2", Repack({178,223,238}) },
 {"lightblue3", Repack({154,192,205}) },
 {"lightblue4", Repack({104,131,139}) },
 {"lightcyan1", Repack({224,255,255}) },
 {"lightcyan2", Repack({209,238,238}) },
 {"lightcyan3", Repack({180,205,205}) },
 {"lightcyan4", Repack({122,139,139}) },
 {"paleturquoise1", Repack({187,255,255}) },
 {"paleturquoise2", Repack({174,238,238}) },
 {"paleturquoise3", Repack({150,205,205}) },
 {"paleturquoise4", Repack({102,139,139}) },
 {"cadetblue1", Repack({152,245,255}) },
 {"cadetblue2", Repack({142,229,238}) },
 {"cadetblue3", Repack({122,197,205}) },
  {"cadetblue4", Repack({83,134,139}) },
   {"turquoise1", Repack({0,245,255}) },
   {"turquoise2", Repack({0,229,238}) },
   {"turquoise3", Repack({0,197,205}) },
   {"turquoise4", Repack({0,134,139}) },
   {"cyan1", Repack({0,255,255}) },
   {"cyan2", Repack({0,238,238}) },
   {"cyan3", Repack({0,205,205}) },
   {"cyan4", Repack({0,139,139}) },
 {"darkslategray1", Repack({151,255,255}) },
 {"darkslategray2", Repack({141,238,238}) },
 {"darkslategray3", Repack({121,205,205}) },
  {"darkslategray4", Repack({82,139,139}) },
 {"aquamarine1", Repack({127,255,212}) },
 {"aquamarine2", Repack({118,238,198}) },
 {"aquamarine3", Repack({102,205,170}) },
  {"aquamarine4", Repack({69,139,116}) },
 {"darkseagreen1", Repack({193,255,193}) },
 {"darkseagreen2", Repack({180,238,180}) },
 {"darkseagreen3", Repack({155,205,155}) },
 {"darkseagreen4", Repack({105,139,105}) },
  {"seagreen1", Repack({84,255,159}) },
  {"seagreen2", Repack({78,238,148}) },
  {"seagreen3", Repack({67,205,128}) },
  {"seagreen4", Repack({46,139,87}) },
 {"palegreen1", Repack({154,255,154}) },
 {"palegreen2", Repack({144,238,144}) },
 {"palegreen3", Repack({124,205,124}) },
  {"palegreen4", Repack({84,139,84}) },
   {"springgreen1", Repack({0,255,127}) },
   {"springgreen2", Repack({0,238,118}) },
   {"springgreen3", Repack({0,205,102}) },
   {"springgreen4", Repack({0,139,69}) },
   {"green1", Repack({0,255,0}) },
   {"green2", Repack({0,238,0}) },
   {"green3", Repack({0,205,0}) },
   {"green4", Repack({0,139,0}) },
 {"chartreuse1", Repack({127,255,0}) },
 {"chartreuse2", Repack({118,238,0}) },
 {"chartreuse3", Repack({102,205,0}) },
  {"chartreuse4", Repack({69,139,0}) },
 {"olivedrab1", Repack({192,255,62}) },
 {"olivedrab2", Repack({179,238,58}) },
 {"olivedrab3", Repack({154,205,50}) },
 {"olivedrab4", Repack({105,139,34}) },
 {"darkolivegreen1", Repack({202,255,112}) },
 {"darkolivegreen2", Repack({188,238,104}) },
 {"darkolivegreen3", Repack({162,205,90}) },
 {"darkolivegreen4", Repack({110,139,61}) },
 {"khaki1", Repack({255,246,143}) },
 {"khaki2", Repack({238,230,133}) },
 {"khaki3", Repack({205,198,115}) },
 {"khaki4", Repack({139,134,78}) },
 {"lightgoldenrod1", Repack({255,236,139}) },
 {"lightgoldenrod2", Repack({238,220,130}) },
 {"lightgoldenrod3", Repack({205,190,112}) },
 {"lightgoldenrod4", Repack({139,129,76}) },
 {"lightyellow1", Repack({255,255,224}) },
 {"lightyellow2", Repack({238,238,209}) },
 {"lightyellow3", Repack({205,205,180}) },
 {"lightyellow4", Repack({139,139,122}) },
 {"yellow1", Repack({255,255,0}) },
 {"yellow2", Repack({238,238,0}) },
 {"yellow3", Repack({205,205,0}) },
 {"yellow4", Repack({139,139,0}) },
 {"gold1", Repack({255,215,0}) },
 {"gold2", Repack({238,201,0}) },
 {"gold3", Repack({205,173,0}) },
 {"gold4", Repack({139,117,0}) },
 {"goldenrod1", Repack({255,193,37}) },
 {"goldenrod2", Repack({238,180,34}) },
 {"goldenrod3", Repack({205,155,29}) },
 {"goldenrod4", Repack({139,105,20}) },
 {"darkgoldenrod1", Repack({255,185,15}) },
 {"darkgoldenrod2", Repack({238,173,14}) },
 {"darkgoldenrod3", Repack({205,149,12}) },
 {"darkgoldenrod4", Repack({139,101,8}) },
 {"rosybrown1", Repack({255,193,193}) },
 {"rosybrown2", Repack({238,180,180}) },
 {"rosybrown3", Repack({205,155,155}) },
 {"rosybrown4", Repack({139,105,105}) },
 {"indianred1", Repack({255,106,106}) },
 {"indianred2", Repack({238,99,99}) },
 {"indianred3", Repack({205,85,85}) },
 {"indianred4", Repack({139,58,58}) },
 {"sienna1", Repack({255,130,71}) },
 {"sienna2", Repack({238,121,66}) },
 {"sienna3", Repack({205,104,57}) },
 {"sienna4", Repack({139,71,38}) },
 {"burlywood1", Repack({255,211,155}) },
 {"burlywood2", Repack({238,197,145}) },
 {"burlywood3", Repack({205,170,125}) },
 {"burlywood4", Repack({139,115,85}) },
 {"wheat1", Repack({255,231,186}) },
 {"wheat2", Repack({238,216,174}) },
 {"wheat3", Repack({205,186,150}) },
 {"wheat4", Repack({139,126,102}) },
 {"tan1", Repack({255,165,79}) },
 {"tan2", Repack({238,154,73}) },
 {"tan3", Repack({205,133,63}) },
 {"tan4", Repack({139,90,43}) },
 {"chocolate1", Repack({255,127,36}) },
 {"chocolate2", Repack({238,118,33}) },
 {"chocolate3", Repack({205,102,29}) },
 {"chocolate4", Repack({139,69,19}) },
 {"firebrick1", Repack({255,48,48}) },
 {"firebrick2", Repack({238,44,44}) },
 {"firebrick3", Repack({205,38,38}) },
 {"firebrick4", Repack({139,26,26}) },
 {"brown1", Repack({255,64,64}) },
 {"brown2", Repack({238,59,59}) },
 {"brown3", Repack({205,51,51}) },
 {"brown4", Repack({139,35,35}) },
 {"salmon1", Repack({255,140,105}) },
 {"salmon2", Repack({238,130,98}) },
 {"salmon3", Repack({205,112,84}) },
 {"salmon4", Repack({139,76,57}) },
 {"lightsalmon1", Repack({255,160,122}) },
 {"lightsalmon2", Repack({238,149,114}) },
 {"lightsalmon3", Repack({205,129,98}) },
 {"lightsalmon4", Repack({139,87,66}) },
 {"orange1", Repack({255,165,0}) },
 {"orange2", Repack({238,154,0}) },
 {"orange3", Repack({205,133,0}) },
 {"orange4", Repack({139,90,0}) },
 {"darkorange1", Repack({255,127,0}) },
 {"darkorange2", Repack({238,118,0}) },
 {"darkorange3", Repack({205,102,0}) },
 {"darkorange4", Repack({139,69,0}) },
 {"coral1", Repack({255,114,86}) },
 {"coral2", Repack({238,106,80}) },
 {"coral3", Repack({205,91,69}) },
 {"coral4", Repack({139,62,47}) },
 {"tomato1", Repack({255,99,71}) },
 {"tomato2", Repack({238,92,66}) },
 {"tomato3", Repack({205,79,57}) },
 {"tomato4", Repack({139,54,38}) },
 {"orangered1", Repack({255,69,0}) },
 {"orangered2", Repack({238,64,0}) },
 {"orangered3", Repack({205,55,0}) },
 {"orangered4", Repack({139,37,0}) },
 {"red1", Repack({255,0,0}) },
 {"red2", Repack({238,0,0}) },
 {"red3", Repack({205,0,0}) },
 {"red4", Repack({139,0,0}) },
 {"debianred", Repack({215,7,81}) },
 {"deeppink1", Repack({255,20,147}) },
 {"deeppink2", Repack({238,18,137}) },
 {"deeppink3", Repack({205,16,118}) },
 {"deeppink4", Repack({139,10,80}) },
 {"hotpink1", Repack({255,110,180}) },
 {"hotpink2", Repack({238,106,167}) },
 {"hotpink3", Repack({205,96,144}) },
 {"hotpink4", Repack({139,58,98}) },
 {"pink1", Repack({255,181,197}) },
 {"pink2", Repack({238,169,184}) },
 {"pink3", Repack({205,145,158}) },
 {"pink4", Repack({139,99,108}) },
 {"lightpink1", Repack({255,174,185}) },
 {"lightpink2", Repack({238,162,173}) },
 {"lightpink3", Repack({205,140,149}) },
 {"lightpink4", Repack({139,95,101}) },
 {"palevioletred1", Repack({255,130,171}) },
 {"palevioletred2", Repack({238,121,159}) },
 {"palevioletred3", Repack({205,104,137}) },
 {"palevioletred4", Repack({139,71,93}) },
 {"maroon1", Repack({255,52,179}) },
 {"maroon2", Repack({238,48,167}) },
 {"maroon3", Repack({205,41,144}) },
 {"maroon4", Repack({139,28,98}) },
 {"violetred1", Repack({255,62,150}) },
 {"violetred2", Repack({238,58,140}) },
 {"violetred3", Repack({205,50,120}) },
 {"violetred4", Repack({139,34,82}) },
 {"magenta1", Repack({255,0,255}) },
 {"magenta2", Repack({238,0,238}) },
 {"magenta3", Repack({205,0,205}) },
 {"magenta4", Repack({139,0,139}) },
 {"orchid1", Repack({255,131,250}) },
 {"orchid2", Repack({238,122,233}) },
 {"orchid3", Repack({205,105,201}) },
 {"orchid4", Repack({139,71,137}) },
 {"plum1", Repack({255,187,255}) },
 {"plum2", Repack({238,174,238}) },
 {"plum3", Repack({205,150,205}) },
 {"plum4", Repack({139,102,139}) },
 {"mediumorchid1", Repack({224,102,255}) },
 {"mediumorchid2", Repack({209,95,238}) },
 {"mediumorchid3", Repack({180,82,205}) },
 {"mediumorchid4", Repack({122,55,139}) },
 {"darkorchid1", Repack({191,62,255}) },
 {"darkorchid2", Repack({178,58,238}) },
 {"darkorchid3", Repack({154,50,205}) },
 {"darkorchid4", Repack({104,34,139}) },
 {"purple1", Repack({155,48,255}) },
 {"purple2", Repack({145,44,238}) },
 {"purple3", Repack({125,38,205}) },
  {"purple4", Repack({85,26,139}) },
 {"mediumpurple1", Repack({171,130,255}) },
 {"mediumpurple2", Repack({159,121,238}) },
 {"mediumpurple3", Repack({137,104,205}) },
  {"mediumpurple4", Repack({93,71,139}) },
 {"thistle1", Repack({255,225,255}) },
 {"thistle2", Repack({238,210,238}) },
 {"thistle3", Repack({205,181,205}) },
 {"thistle4", Repack({139,123,139}) },
   {"gray0", Repack({0,0,0}) },
   {"grey0", Repack({0,0,0}) },
   {"gray1", Repack({3,3,3}) },
   {"grey1", Repack({3,3,3}) },
   {"gray2", Repack({5,5,5}) },
   {"grey2", Repack({5,5,5}) },
   {"gray3", Repack({8,8,8}) },
   {"grey3", Repack({8,8,8}) },
  {"gray4", Repack({10,10,10}) },
  {"grey4", Repack({10,10,10}) },
  {"gray5", Repack({13,13,13}) },
  {"grey5", Repack({13,13,13}) },
  {"gray6", Repack({15,15,15}) },
  {"grey6", Repack({15,15,15}) },
  {"gray7", Repack({18,18,18}) },
  {"grey7", Repack({18,18,18}) },
  {"gray8", Repack({20,20,20}) },
  {"grey8", Repack({20,20,20}) },
  {"gray9", Repack({23,23,23}) },
  {"grey9", Repack({23,23,23}) },
  {"gray10", Repack({26,26,26}) },
  {"grey10", Repack({26,26,26}) },
  {"gray11", Repack({28,28,28}) },
  {"grey11", Repack({28,28,28}) },
  {"gray12", Repack({31,31,31}) },
  {"grey12", Repack({31,31,31}) },
  {"gray13", Repack({33,33,33}) },
  {"grey13", Repack({33,33,33}) },
  {"gray14", Repack({36,36,36}) },
  {"grey14", Repack({36,36,36}) },
  {"gray15", Repack({38,38,38}) },
  {"grey15", Repack({38,38,38}) },
  {"gray16", Repack({41,41,41}) },
  {"grey16", Repack({41,41,41}) },
  {"gray17", Repack({43,43,43}) },
  {"grey17", Repack({43,43,43}) },
  {"gray18", Repack({46,46,46}) },
  {"grey18", Repack({46,46,46}) },
  {"gray19", Repack({48,48,48}) },
  {"grey19", Repack({48,48,48}) },
  {"gray20", Repack({51,51,51}) },
  {"grey20", Repack({51,51,51}) },
  {"gray21", Repack({54,54,54}) },
  {"grey21", Repack({54,54,54}) },
  {"gray22", Repack({56,56,56}) },
  {"grey22", Repack({56,56,56}) },
  {"gray23", Repack({59,59,59}) },
  {"grey23", Repack({59,59,59}) },
  {"gray24", Repack({61,61,61}) },
  {"grey24", Repack({61,61,61}) },
  {"gray25", Repack({64,64,64}) },
  {"grey25", Repack({64,64,64}) },
  {"gray26", Repack({66,66,66}) },
  {"grey26", Repack({66,66,66}) },
  {"gray27", Repack({69,69,69}) },
  {"grey27", Repack({69,69,69}) },
  {"gray28", Repack({71,71,71}) },
  {"grey28", Repack({71,71,71}) },
  {"gray29", Repack({74,74,74}) },
  {"grey29", Repack({74,74,74}) },
  {"gray30", Repack({77,77,77}) },
  {"grey30", Repack({77,77,77}) },
  {"gray31", Repack({79,79,79}) },
  {"grey31", Repack({79,79,79}) },
  {"gray32", Repack({82,82,82}) },
  {"grey32", Repack({82,82,82}) },
  {"gray33", Repack({84,84,84}) },
  {"grey33", Repack({84,84,84}) },
  {"gray34", Repack({87,87,87}) },
  {"grey34", Repack({87,87,87}) },
  {"gray35", Repack({89,89,89}) },
  {"grey35", Repack({89,89,89}) },
  {"gray36", Repack({92,92,92}) },
  {"grey36", Repack({92,92,92}) },
  {"gray37", Repack({94,94,94}) },
  {"grey37", Repack({94,94,94}) },
  {"gray38", Repack({97,97,97}) },
  {"grey38", Repack({97,97,97}) },
  {"gray39", Repack({99,99,99}) },
  {"grey39", Repack({99,99,99}) },
 {"gray40", Repack({102,102,102}) },
 {"grey40", Repack({102,102,102}) },
 {"gray41", Repack({105,105,105}) },
 {"grey41", Repack({105,105,105}) },
 {"gray42", Repack({107,107,107}) },
 {"grey42", Repack({107,107,107}) },
 {"gray43", Repack({110,110,110}) },
 {"grey43", Repack({110,110,110}) },
 {"gray44", Repack({112,112,112}) },
 {"grey44", Repack({112,112,112}) },
 {"gray45", Repack({115,115,115}) },
 {"grey45", Repack({115,115,115}) },
 {"gray46", Repack({117,117,117}) },
 {"grey46", Repack({117,117,117}) },
 {"gray47", Repack({120,120,120}) },
 {"grey47", Repack({120,120,120}) },
 {"gray48", Repack({122,122,122}) },
 {"grey48", Repack({122,122,122}) },
 {"gray49", Repack({125,125,125}) },
 {"grey49", Repack({125,125,125}) },
 {"gray50", Repack({127,127,127}) },
 {"grey50", Repack({127,127,127}) },
 {"gray51", Repack({130,130,130}) },
 {"grey51", Repack({130,130,130}) },
 {"gray52", Repack({133,133,133}) },
 {"grey52", Repack({133,133,133}) },
 {"gray53", Repack({135,135,135}) },
 {"grey53", Repack({135,135,135}) },
 {"gray54", Repack({138,138,138}) },
 {"grey54", Repack({138,138,138}) },
 {"gray55", Repack({140,140,140}) },
 {"grey55", Repack({140,140,140}) },
 {"gray56", Repack({143,143,143}) },
 {"grey56", Repack({143,143,143}) },
 {"gray57", Repack({145,145,145}) },
 {"grey57", Repack({145,145,145}) },
 {"gray58", Repack({148,148,148}) },
 {"grey58", Repack({148,148,148}) },
 {"gray59", Repack({150,150,150}) },
 {"grey59", Repack({150,150,150}) },
 {"gray60", Repack({153,153,153}) },
 {"grey60", Repack({153,153,153}) },
 {"gray61", Repack({156,156,156}) },
 {"grey61", Repack({156,156,156}) },
 {"gray62", Repack({158,158,158}) },
 {"grey62", Repack({158,158,158}) },
 {"gray63", Repack({161,161,161}) },
 {"grey63", Repack({161,161,161}) },
 {"gray64", Repack({163,163,163}) },
 {"grey64", Repack({163,163,163}) },
 {"gray65", Repack({166,166,166}) },
 {"grey65", Repack({166,166,166}) },
 {"gray66", Repack({168,168,168}) },
 {"grey66", Repack({168,168,168}) },
 {"gray67", Repack({171,171,171}) },
 {"grey67", Repack({171,171,171}) },
 {"gray68", Repack({173,173,173}) },
 {"grey68", Repack({173,173,173}) },
 {"gray69", Repack({176,176,176}) },
 {"grey69", Repack({176,176,176}) },
 {"gray70", Repack({179,179,179}) },
 {"grey70", Repack({179,179,179}) },
 {"gray71", Repack({181,181,181}) },
 {"grey71", Repack({181,181,181}) },
 {"gray72", Repack({184,184,184}) },
 {"grey72", Repack({184,184,184}) },
 {"gray73", Repack({186,186,186}) },
 {"grey73", Repack({186,186,186}) },
 {"gray74", Repack({189,189,189}) },
 {"grey74", Repack({189,189,189}) },
 {"gray75", Repack({191,191,191}) },
 {"grey75", Repack({191,191,191}) },
 {"gray76", Repack({194,194,194}) },
 {"grey76", Repack({194,194,194}) },
 {"gray77", Repack({196,196,196}) },
 {"grey77", Repack({196,196,196}) },
 {"gray78", Repack({199,199,199}) },
 {"grey78", Repack({199,199,199}) },
 {"gray79", Repack({201,201,201}) },
 {"grey79", Repack({201,201,201}) },
 {"gray80", Repack({204,204,204}) },
 {"grey80", Repack({204,204,204}) },
 {"gray81", Repack({207,207,207}) },
 {"grey81", Repack({207,207,207}) },
 {"gray82", Repack({209,209,209}) },
 {"grey82", Repack({209,209,209}) },
 {"gray83", Repack({212,212,212}) },
 {"grey83", Repack({212,212,212}) },
 {"gray84", Repack({214,214,214}) },
 {"grey84", Repack({214,214,214}) },
 {"gray85", Repack({217,217,217}) },
 {"grey85", Repack({217,217,217}) },
 {"gray86", Repack({219,219,219}) },
 {"grey86", Repack({219,219,219}) },
 {"gray87", Repack({222,222,222}) },
 {"grey87", Repack({222,222,222}) },
 {"gray88", Repack({224,224,224}) },
 {"grey88", Repack({224,224,224}) },
 {"gray89", Repack({227,227,227}) },
 {"grey89", Repack({227,227,227}) },
 {"gray90", Repack({229,229,229}) },
 {"grey90", Repack({229,229,229}) },
 {"gray91", Repack({232,232,232}) },
 {"grey91", Repack({232,232,232}) },
 {"gray92", Repack({235,235,235}) },
 {"grey92", Repack({235,235,235}) },
 {"gray93", Repack({237,237,237}) },
 {"grey93", Repack({237,237,237}) },
 {"gray94", Repack({240,240,240}) },
 {"grey94", Repack({240,240,240}) },
 {"gray95", Repack({242,242,242}) },
 {"grey95", Repack({242,242,242}) },
 {"gray96", Repack({245,245,245}) },
 {"grey96", Repack({245,245,245}) },
 {"gray97", Repack({247,247,247}) },
 {"grey97", Repack({247,247,247}) },
 {"gray98", Repack({250,250,250}) },
 {"grey98", Repack({250,250,250}) },
 {"gray99", Repack({252,252,252}) },
 {"grey99", Repack({252,252,252}) },
 {"gray100", Repack({255,255,255}) },
 {"grey100", Repack({255,255,255}) },
 {"dark grey", Repack({169,169,169}) },
 {"darkgrey", Repack({169,169,169}) },
 {"dark gray", Repack({169,169,169}) },
 {"darkgray", Repack({169,169,169}) },
 {"dark blue", Repack({0,0,139}) },
 {"darkblue", Repack({0,0,139}) },
 {"dark cyan", Repack({0,139,139}) },
 {"darkcyan", Repack({0,139,139}) },
 {"dark magenta", Repack({139,0,139}) },
 {"darkmagenta", Repack({139,0,139}) },
 {"dark red", Repack({139,0,0}) },
 {"darkred", Repack({139,0,0}) },
 {"light green", Repack({144,238,144}) },
 {"lightgreen", Repack({144,238,144}) },
};

static std::pair<unsigned long long, unsigned> ParseHex(const char*& s)
{
    char* endptr = nullptr;
    unsigned long long result = strtoll(s, &endptr, 16);
    unsigned length = endptr-s;
    s = endptr;
    return {result, length};
}

unsigned ParseColorName(std::string_view s)
{
    std::string lc(s);
    for(char c: lc) c = tolower(c);
    if(lc.compare(0,1,"#") == 0)
    {
        const char* p = lc.data()+1;
        auto[val, length] = ParseHex(p);
        unsigned result = 0;
        unsigned bits = length/3*4;
        for(unsigned n=0; n<3; ++n)
        {
            unsigned mask = ((0x1u << bits)-1);
            unsigned temp = val & mask; val >>= bits;
            temp = temp * 0xFF / mask;
            result += temp << (8*n);
        }
        return result;
    }
    if(lc.compare(0,4,"rgb:") == 0)
    {
        const char* p = lc.data()+4;
    	unsigned result = 0;
    	for(unsigned n=0; n<3; ++n)
    	{
    	    while(*p == '/') ++p;
    	    auto[val, length] = ParseHex(p);
    	    unsigned bits = length*4;
            unsigned mask = ((0x1u << bits)-1);
            unsigned temp = val & mask; val >>= bits;
            result <<= 8;
            result += temp * 0xFF / mask;
    	}
    	return result;
    }
    if(auto i = colornames.find(lc); i != colornames.end())
    	return i->second;
    return 0;
}
